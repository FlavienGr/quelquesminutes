sudo: required
cache:
    directories:
     - /node_modules
     - ./e2e/node_modules
services:
  - docker
script:
  - docker-compose -f docker-compose.ci.yml up --build
  - docker-compose -f docker-compose.ci.yml down
after_success:
  - docker build -t zencles/quelquesminutes-cypress ./e2e
  - docker build -t zencles/quelquesminutes .
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - docker push zencles/quelquesminutes
  - docker push zencles/quelquesminutes-cypress
  - echo "SUCCESS!"
notifications:
  email: true
