sudo: required
cache:
    directories:
     - /node_modules
     - ./e2e/node_modules
services:
  - docker
script:
  - docker-compose -f docker-compose.ci.yml up -d --build
  - docker-compose logs e2e
after_success:
  - docker-compose -f docker-compose.ci.yml down -v
  - docker build -t zencles/quelquesminutes .
  - docker build -t zencles/cypress-quelquesminutes ./e2e
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - docker push zencles/quelquesminutes
  - docker push zencles/cypress-quelquesminutes
  - echo "SUCCESS!"
notifications:
  email: false
